---
title: Plant Ontology
author: Lucas
date: '2022-10-09'
slug: []
categories: []
tags: []
image:
  caption: ''
  focal_point: ''
---



<pre class="r"><code>library(ontologyIndex)
library(ontologyPlot)</code></pre>
<pre><code>## Warning: package &#39;ontologyPlot&#39; was built under R version 4.0.5</code></pre>
<pre class="r"><code>library(dplyr)</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>PO &lt;- get_ontology(
  
  &quot;http://purl.obolibrary.org/obo/po.obo&quot;,
  propagate_relationships = &quot;is_a&quot;,
  extract_tags = &quot;everything&quot;,
  merge_equivalent_terms = TRUE
  
)

group &lt;- get_ancestors(
  
  PO, 
  c(
    
    &quot;PO:0020020&quot;, 
    &quot;PO:0025277&quot;, 
    &quot;PO:0009001&quot;,
    &quot;PO:0030109&quot;,
    &quot;PO:0030108&quot;,
    &quot;PO:0030105&quot;,
    &quot;PO:0030104&quot;,
    &quot;PO:0030107&quot;,
    &quot;PO:0030106&quot;,
    &quot;PO:0030101&quot;,
    &quot;PO:0030100&quot;,
    &quot;PO:0030103&quot;,
    &quot;PO:0030102&quot;,
    &quot;PO:0030110&quot;,
    &quot;PO:0030111&quot;,
    &quot;PO:0030091&quot;,
    &quot;PO:0030099&quot;,
    &quot;PO:0030098&quot;
    
  )
  
)

group.length &lt;- length(group)
group.n &lt;- 1:group.length


nodes.id &lt;- group.n

nodes.label &lt;- NULL
for(i in group.n){
  
  nodes.label.this &lt;- PO$name[which(group[i] == PO$id)]
  nodes.label &lt;- c(nodes.label, nodes.label.this)
  
}

nodes.title &lt;- NULL
for(i in group.n){
  
  nodes.title.this &lt;- PO$comment[which(group[i] == PO$id)]
  nodes.title &lt;- c(nodes.title, nodes.title.this)
  
}

nodes &lt;- data.frame(
  
  id = nodes.id,
  label = nodes.label,
  title = nodes.title
  
)


edges.is_a &lt;- data.frame(
  
  from = names(PO$is_a),
  to = as.character(PO$is_a)
  
)

edges.is_a &lt;- edges.is_a %&gt;% dplyr::filter(from %in% group)

for(i in group.n){
  
  edges.is_a$from[i] &lt;- which(edges.is_a$from[i] == rownames(nodes))
  
}

edges.is_a$to &lt;- sub(&quot;BFO.*&quot;, &quot;&quot;, edges.is_a$to)
  
for(i in group.n){
  
  if(length(which(edges.is_a$to[i] == rownames(nodes))) == 0){} else {
    
    edges.is_a$to[i] &lt;- which(edges.is_a$to[i] == rownames(nodes))
    
  }
  
}


edges &lt;- data.frame(
  
  from = edges.is_a$from, 
  to = edges.is_a$to,
  label = &quot;is_a&quot;,
  arrows = &quot;to&quot;
  
)

graph &lt;- visNetwork::visNetwork(nodes, edges)

visNetwork::visSave(graph, &quot;network.html&quot;, selfcontained = TRUE, background = &quot;white&quot;)</code></pre>
<pre class="r"><code>knitr::include_url(&quot;network.html&quot;)</code></pre>
<iframe src="network.html" width="672" height="400px" data-external="1">
</iframe>
